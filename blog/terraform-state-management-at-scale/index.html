<!DOCTYPE html><!--lmWS_xeel_4S4rojSV0d7--><html lang="en" data-theme="dark"><head><meta charSet="utf-8"/><link rel="preconnect" href="/" crossorigin=""/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/chunks/d43ab978ac5b76ce.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/chunks/6df63831065a6eda.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/c6108499b026e905.js"/><script src="/_next/static/chunks/82abf2d65f5428ae.js" async=""></script><script src="/_next/static/chunks/77894f20d69fc753.js" async=""></script><script src="/_next/static/chunks/f2f58a7e93290fbb.js" async=""></script><script src="/_next/static/chunks/turbopack-1c41214f192bd954.js" async=""></script><script src="/_next/static/chunks/9168958f931f481a.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/d2be314c3ece3fbe.js" async=""></script><script src="/_next/static/chunks/57336b526124bb98.js" async=""></script><link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&amp;family=JetBrains+Mono:wght@400;500;600;700&amp;display=swap" as="style"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><title>Amar Sattaur | Blog</title><meta name="description" content="Technical writing on Kubernetes, CI/CD, Terraform, and incident leadership."/><meta name="author" content="Amar Sattaur"/><meta name="keywords" content="DevOps Engineer,Platform Engineer,Staff Engineer,Kubernetes,EKS,ArgoCD,Terraform,AWS,GCP,Oracle Cloud,CI/CD,Infrastructure,SRE,GitHub Actions"/><meta name="creator" content="Amar Sattaur"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://jodybro.github.io/blog/"/><meta property="og:title" content="Amar Sattaur | Blog"/><meta property="og:description" content="Technical writing on Kubernetes, CI/CD, Terraform, and incident leadership."/><meta property="og:url" content="https://jodybro.github.io/blog/"/><meta property="og:image" content="https://jodybro.github.io/og-blog.svg"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:alt" content="Amar Sattaur blog preview"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Amar Sattaur | Blog"/><meta name="twitter:description" content="Technical writing on Kubernetes, CI/CD, Terraform, and incident leadership."/><meta name="twitter:image" content="https://jodybro.github.io/og-blog.svg"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&amp;family=JetBrains+Mono:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Person","name":"Amar Sattaur","jobTitle":"Staff DevOps & Platform Engineer","description":"Staff-level DevOps and Platform Engineer specializing in Kubernetes orchestration, CI/CD pipeline architecture, and cloud infrastructure automation.","url":"https://jodybro.github.io","email":"ajodasattaur@gmail.com","sameAs":["https://github.com/jodybro","https://linkedin.com/in/amar-sattaur"],"knowsAbout":["Kubernetes","Amazon EKS","Google GKE","ArgoCD","Terraform","GitHub Actions","CI/CD","DevOps","Platform Engineering","Cloud Infrastructure","AWS","GCP","Oracle Cloud"],"worksFor":{"@type":"Organization","name":"Mogo Financial"}}</script><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><nav class="navbar navbar-expand-lg fixed-top"><div class="container"><a class="navbar-brand text-info" href="/"><i class="bi bi-terminal me-2"></i>amarsattaur</a><button class="navbar-toggler border-0" type="button" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><i class="bi bi-list toggler-icon fs-4"></i></button><div class="navbar-collapse d-none d-lg-flex" id="navbarNav"><ul class="navbar-nav ms-auto nav-compact"><li class="nav-item"><a class="nav-link " href="/#about">About</a></li><li class="nav-item"><a class="nav-link" href="/#experience">Experience</a></li><li class="nav-item dropdown"><button class="nav-link dropdown-toggle btn btn-link active" type="button" aria-expanded="false">Content</button><ul class="dropdown-menu "><li><a class="dropdown-item" href="/blog/"><i class="bi bi-journal-text me-2"></i>Blog</a></li><li><a class="dropdown-item" href="/#case-studies"><i class="bi bi-briefcase me-2"></i>Case Studies</a></li></ul></li><li class="nav-item"><a class="nav-link " href="/incidents/">Incidents</a></li><li class="nav-item"><a class="nav-link" href="/#contact">Contact</a></li></ul><div class="search-container ms-lg-2 mt-3 mt-lg-0"><button class="btn nav-icon-btn" aria-label="Search"><i class="bi bi-search"></i></button></div><button class="btn nav-icon-btn ms-lg-2 mt-3 mt-lg-0" aria-label="Toggle theme"><i class="bi bi-sun"></i></button><div class="dropdown ms-lg-2 mt-3 mt-lg-0 resume-dropdown"><button type="button" class="btn btn-resume dropdown-toggle" aria-expanded="false"><i class="bi bi-file-earmark-text me-1"></i>Resume</button><ul class="dropdown-menu dropdown-menu-end "><li><a class="dropdown-item" href="/resume/"><i class="bi bi-eye me-2"></i>View</a></li><li><a class="dropdown-item" href="/Amar_Sattaur_Resume.pdf" download=""><i class="bi bi-download me-2"></i>Download</a></li></ul></div></div></div></nav><article class="py-5" style="padding-top:120px"><div class="container py-5"><div class="row"><div class="col-lg-3 d-none d-lg-block"></div><div class="col-lg-8"><nav aria-label="breadcrumb" class="mb-4"><ol class="breadcrumb"><li class="breadcrumb-item"><a class="text-info" href="/">Home</a></li><li class="breadcrumb-item"><a class="text-info" href="/blog/">Blog</a></li><li class="breadcrumb-item active text-secondary">Terraform State at Scale</li></ol></nav><header class="mb-5"><div class="d-flex flex-wrap gap-2 mb-3"><button type="button" class="tech-badge tech-badge-clickable" aria-label="Add Terraform to search filters" title="Click to search for Terraform">Terraform</button><button type="button" class="tech-badge tech-badge-clickable" aria-label="Add IaC to search filters" title="Click to search for IaC">IaC</button><button type="button" class="tech-badge tech-badge-clickable" aria-label="Add DevOps to search filters" title="Click to search for DevOps">DevOps</button><button type="button" class="tech-badge tech-badge-clickable" aria-label="Add AWS to search filters" title="Click to search for AWS">AWS</button></div><h1 class="display-5 fw-bold mb-3">Terraform State Management at Scale</h1><div class="d-flex align-items-center text-secondary"><span>February 2025</span><span class="mx-2">•</span><span>10 min read</span></div></header><div class="blog-content"><p class="lead text-secondary mb-4">Terraform state is straightforward when you have a single team managing a handful of resources. It becomes a minefield when you scale to dozens of environments, multiple teams, and thousands of resources. This post covers the patterns and practices that keep state manageable at scale.</p><h2 id="the-problem" class="h3 mt-5 mb-3 text-info">The Problem with State at Scale</h2><p class="text-secondary">Every Terraform deployment maintains a state file that maps your configuration to real-world resources. When organizations grow, common state-related problems emerge:</p><ul class="text-secondary"><li><strong>State collisions:</strong> Two engineers running <code>terraform apply</code> simultaneously, corrupting state</li><li><strong>Monolithic state:</strong> A single state file tracking thousands of resources, making plans slow and risky</li><li><strong>Environment drift:</strong> No clear separation between dev, staging, and production state</li><li><strong>Access control gaps:</strong> Everyone having write access to production state</li><li><strong>Migration pain:</strong> Moving resources between state files without destroying and recreating them</li></ul><h2 id="remote-backend-setup" class="h3 mt-5 mb-3 text-info">Remote Backend Setup</h2><p class="text-secondary">The first step is moving from local state to a remote backend. For AWS environments, S3 with DynamoDB locking is the standard pattern.</p><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">backend.tf</span></div><div class="terminal-body"><pre class="text-success mb-0">terraform {
  backend &quot;s3&quot; {
    bucket         = &quot;acme-terraform-state&quot;
    key            = &quot;networking/vpc/terraform.tfstate&quot;
    region         = &quot;us-east-1&quot;
    encrypt        = true
    dynamodb_table = &quot;terraform-state-locks&quot;
    # Use separate AWS profile for state access
    profile        = &quot;terraform-state&quot;
  }
}</pre></div></div><h3 id="bootstrap-the-backend" class="h5 mt-4 mb-3">Bootstrapping the Backend</h3><p class="text-secondary">There&#x27;s a chicken-and-egg problem: you need infrastructure to store state, but you use Terraform to create infrastructure. The solution is a small bootstrap module that creates the state resources themselves.</p><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">bootstrap/main.tf</span></div><div class="terminal-body"><pre class="text-success mb-0"># This module uses local state intentionally.
# Run once, then store its state in version control.

resource &quot;aws_s3_bucket&quot; &quot;terraform_state&quot; {
  bucket = &quot;acme-terraform-state&quot;

  lifecycle {
    prevent_destroy = true
  }
}

resource &quot;aws_s3_bucket_versioning&quot; &quot;terraform_state&quot; {
  bucket = aws_s3_bucket.terraform_state.id
  versioning_configuration {
    status = &quot;Enabled&quot;
  }
}

resource &quot;aws_s3_bucket_server_side_encryption_configuration&quot; &quot;terraform_state&quot; {
  bucket = aws_s3_bucket.terraform_state.id
  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = &quot;aws:kms&quot;
    }
  }
}

resource &quot;aws_dynamodb_table&quot; &quot;terraform_locks&quot; {
  name         = &quot;terraform-state-locks&quot;
  billing_mode = &quot;PAY_PER_REQUEST&quot;
  hash_key     = &quot;LockID&quot;

  attribute {
    name = &quot;LockID&quot;
    type = &quot;S&quot;
  }
}</pre></div></div><p class="text-secondary">Key details: S3 versioning lets you recover from corrupted state by rolling back to a previous version. KMS encryption protects secrets stored in state. The DynamoDB table provides distributed locking to prevent concurrent modifications.</p><h2 id="state-decomposition" class="h3 mt-5 mb-3 text-info">State Decomposition Strategies</h2><p class="text-secondary">A monolithic state file is the single biggest scaling bottleneck. When one state file tracks your VPC, EKS cluster, databases, and application configs, a <code>terraform plan</code> takes minutes and a failed apply can block every team.</p><h3 id="split-by-lifecycle" class="h5 mt-4 mb-3">Split by Lifecycle</h3><p class="text-secondary">Group resources by how often they change and who changes them:</p><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">Recommended directory structure</span></div><div class="terminal-body"><pre class="text-success mb-0">infrastructure/
├── bootstrap/              # State backend (local state, committed)
├── networking/
│   ├── vpc/                # VPC, subnets, route tables (rarely changes)
│   └── dns/                # Route53 zones, records
├── platform/
│   ├── eks/                # EKS cluster, node groups
│   ├── rds/                # Database instances
│   └── elasticache/        # Redis/Memcached clusters
├── security/
│   ├── iam/                # IAM roles, policies
│   └── kms/                # Encryption keys
└── services/
    ├── api-gateway/        # API Gateway configs (changes frequently)
    └── lambda/             # Lambda functions</pre></div></div><p class="text-secondary">Each directory is a separate Terraform root module with its own state file. The <code>networking/vpc</code> state might change quarterly, while <code>services/api-gateway</code> changes weekly. This isolation means a team updating Lambda functions never risks blocking the networking team.</p><h3 id="cross-state-references" class="h5 mt-4 mb-3">Cross-State References</h3><p class="text-secondary">When modules are split, they still need to reference each other. Use <code>terraform_remote_state</code> data sources or, better yet, SSM Parameter Store for loose coupling.</p><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">Option A: terraform_remote_state</span></div><div class="terminal-body"><pre class="text-success mb-0"># In platform/eks/main.tf - read VPC outputs
data &quot;terraform_remote_state&quot; &quot;vpc&quot; {
  backend = &quot;s3&quot;
  config = {
    bucket = &quot;acme-terraform-state&quot;
    key    = &quot;networking/vpc/terraform.tfstate&quot;
    region = &quot;us-east-1&quot;
  }
}

resource &quot;aws_eks_cluster&quot; &quot;main&quot; {
  name     = &quot;acme-production&quot;
  role_arn = var.cluster_role_arn

  vpc_config {
    subnet_ids = data.terraform_remote_state.vpc.outputs.private_subnet_ids
  }
}</pre></div></div><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">Option B: SSM Parameter Store (preferred)</span></div><div class="terminal-body"><pre class="text-success mb-0"># In networking/vpc/outputs.tf - publish to SSM
resource &quot;aws_ssm_parameter&quot; &quot;vpc_id&quot; {
  name  = &quot;/infrastructure/networking/vpc_id&quot;
  type  = &quot;String&quot;
  value = aws_vpc.main.id
}

resource &quot;aws_ssm_parameter&quot; &quot;private_subnets&quot; {
  name  = &quot;/infrastructure/networking/private_subnet_ids&quot;
  type  = &quot;StringList&quot;
  value = join(&quot;,&quot;, aws_subnet.private[*].id)
}

# In platform/eks/main.tf - read from SSM
data &quot;aws_ssm_parameter&quot; &quot;vpc_id&quot; {
  name = &quot;/infrastructure/networking/vpc_id&quot;
}

data &quot;aws_ssm_parameter&quot; &quot;private_subnets&quot; {
  name = &quot;/infrastructure/networking/private_subnet_ids&quot;
}</pre></div></div><p class="text-secondary">SSM Parameter Store is preferred because it decouples the consumer from the producer&#x27;s state backend configuration. If the VPC team migrates their state to a different bucket, consumers don&#x27;t need to update anything.</p><h2 id="workspace-patterns" class="h3 mt-5 mb-3 text-info">Workspace Patterns for Environments</h2><p class="text-secondary">Terraform workspaces provide isolated state within the same configuration. They&#x27;re useful for managing multiple environments (dev, staging, prod) from a single codebase, but they come with trade-offs.</p><div class="custom-card p-4 my-4"><h5 class="text-info mb-3"><i class="bi bi-signpost-split me-2"></i>Workspaces vs. Directory Separation</h5><div class="table-responsive"><table class="table table-borderless text-secondary"><thead><tr><th>Approach</th><th>Pros</th><th>Cons</th></tr></thead><tbody><tr><td><strong>Workspaces</strong></td><td>DRY code, single source of truth</td><td>All envs share same config, risky blast radius</td></tr><tr><td><strong>Directories</strong></td><td>Full isolation, independent deploys</td><td>Code duplication, drift between envs</td></tr><tr><td><strong>Hybrid</strong></td><td>Shared modules, env-specific roots</td><td>More repo structure to maintain</td></tr></tbody></table></div></div><p class="text-secondary">The hybrid approach works best at scale: shared modules define the “what” while environment-specific root modules define the “how much” and “where.”</p><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">Hybrid structure</span></div><div class="terminal-body"><pre class="text-success mb-0">infrastructure/
├── modules/                    # Shared, versioned modules
│   ├── vpc/
│   ├── eks-cluster/
│   └── rds-instance/
├── environments/
│   ├── dev/
│   │   ├── main.tf             # module &quot;vpc&quot; { source = &quot;../../modules/vpc&quot; }
│   │   ├── terraform.tfvars    # instance_type = &quot;t3.medium&quot;
│   │   └── backend.tf          # key = &quot;dev/platform/terraform.tfstate&quot;
│   ├── staging/
│   │   ├── main.tf
│   │   ├── terraform.tfvars    # instance_type = &quot;t3.large&quot;
│   │   └── backend.tf          # key = &quot;staging/platform/terraform.tfstate&quot;
│   └── prod/
│       ├── main.tf
│       ├── terraform.tfvars    # instance_type = &quot;m5.xlarge&quot;
│       └── backend.tf          # key = &quot;prod/platform/terraform.tfstate&quot;</pre></div></div><h2 id="state-locking" class="h3 mt-5 mb-3 text-info">State Locking Deep Dive</h2><p class="text-secondary">State locking prevents concurrent operations on the same state file. Without it, two simultaneous <code>terraform apply</code> runs can corrupt state irreversibly.</p><h3 id="when-locks-go-wrong" class="h5 mt-4 mb-3">When Locks Go Wrong</h3><p class="text-secondary">Sometimes a Terraform run crashes or is interrupted, leaving a stale lock. Here&#x27;s how to handle it safely:</p><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">Handling stale locks</span></div><div class="terminal-body"><pre class="text-success mb-0"># Step 1: Verify the lock is actually stale
# Check who holds it and when it was acquired
aws dynamodb get-item \
  --table-name terraform-state-locks \
  --key &#x27;{&quot;LockID&quot;: {&quot;S&quot;: &quot;acme-terraform-state/networking/vpc/terraform.tfstate-md5&quot;}}&#x27; \
  --output json | jq &#x27;.Item.Info.S | fromjson&#x27;

# Step 2: Confirm no active Terraform process is running
# Check CI/CD pipelines and ask the team

# Step 3: Force unlock only when certain
terraform force-unlock LOCK_ID

# NEVER force-unlock without verifying steps 1 and 2</pre></div></div><h2 id="safe-state-migration" class="h3 mt-5 mb-3 text-info">Safe State Migration</h2><p class="text-secondary">Moving resources between state files is one of the riskiest Terraform operations. A mistake can cause Terraform to destroy and recreate production resources. Here&#x27;s a safe procedure.</p><h3 id="migration-procedure" class="h5 mt-4 mb-3">Migration Procedure</h3><ol class="text-secondary"><li>Take a snapshot of both source and destination state files</li><li>Run <code>terraform plan</code> on both to confirm clean state</li><li>Move resources using <code>terraform state mv</code></li><li>Run <code>terraform plan</code> on both again—expect no changes</li><li>If plan shows changes, restore from snapshot and investigate</li></ol><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">State migration example</span></div><div class="terminal-body"><pre class="text-success mb-0">#!/bin/bash
set -euo pipefail

# 1. Snapshot current state
echo &quot;Taking state snapshots...&quot;
cd infrastructure/monolith
terraform state pull &gt; /tmp/monolith-state-backup.json

cd ../networking/vpc
terraform state pull &gt; /tmp/vpc-state-backup.json

# 2. Verify clean plans
echo &quot;Verifying clean state...&quot;
cd ../../monolith
terraform plan -detailed-exitcode  # Exit code 0 = no changes

cd ../networking/vpc
terraform plan -detailed-exitcode

# 3. Move resources
echo &quot;Moving VPC resources...&quot;
cd ../../monolith
terraform state mv \
  -state-out=../networking/vpc/terraform.tfstate \
  &#x27;aws_vpc.main&#x27; &#x27;aws_vpc.main&#x27;

terraform state mv \
  -state-out=../networking/vpc/terraform.tfstate \
  &#x27;aws_subnet.private&#x27; &#x27;aws_subnet.private&#x27;

# 4. Verify both states show no changes
echo &quot;Verifying migration...&quot;
terraform plan -detailed-exitcode

cd ../networking/vpc
terraform plan -detailed-exitcode

echo &quot;Migration complete. Both states are clean.&quot;</pre></div></div><div class="custom-card p-4 my-4"><h5 class="text-info mb-3"><i class="bi bi-exclamation-triangle me-2"></i>Migration Safety Checklist</h5><ul class="text-secondary mb-0"><li>Always back up state files before any migration</li><li>Run migrations during a maintenance window—no concurrent applies</li><li>Use <code>-lock=true</code> (the default) to hold locks during migration</li><li>Test the migration in a non-production environment first</li><li>Have a rollback plan: restoring the state snapshot</li></ul></div><h2 id="access-control" class="h3 mt-5 mb-3 text-info">Access Control for State</h2><p class="text-secondary">Not everyone should have write access to production state. Use S3 bucket policies and IAM to enforce least-privilege access.</p><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">IAM policy for state access</span></div><div class="terminal-body"><pre class="text-success mb-0">{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;AllowStateRead&quot;,
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: [&quot;s3:GetObject&quot;, &quot;s3:ListBucket&quot;],
      &quot;Resource&quot;: [
        &quot;arn:aws:s3:::acme-terraform-state&quot;,
        &quot;arn:aws:s3:::acme-terraform-state/*&quot;
      ]
    },
    {
      &quot;Sid&quot;: &quot;AllowProdStateWrite&quot;,
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: [&quot;s3:PutObject&quot;, &quot;s3:DeleteObject&quot;],
      &quot;Resource&quot;: &quot;arn:aws:s3:::acme-terraform-state/prod/*&quot;,
      &quot;Condition&quot;: {
        &quot;StringEquals&quot;: {
          &quot;aws:PrincipalTag/team&quot;: &quot;platform&quot;
        }
      }
    },
    {
      &quot;Sid&quot;: &quot;AllowDevStateWrite&quot;,
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: [&quot;s3:PutObject&quot;, &quot;s3:DeleteObject&quot;],
      &quot;Resource&quot;: &quot;arn:aws:s3:::acme-terraform-state/dev/*&quot;
    }
  ]
}</pre></div></div><p class="text-secondary">This policy allows all engineers to read any state (useful for <code>terraform_remote_state</code> lookups) but restricts production state writes to the platform team. Dev state is open for all engineers to modify.</p><h2 id="ci-cd-integration" class="h3 mt-5 mb-3 text-info">CI/CD Integration</h2><p class="text-secondary">Running Terraform from CI/CD pipelines enforces consistency and provides audit trails. Here&#x27;s a GitHub Actions workflow pattern that separates plan from apply.</p><div class="terminal-card my-4"><div class="terminal-header"><div class="terminal-dot terminal-dot-red"></div><div class="terminal-dot terminal-dot-yellow"></div><div class="terminal-dot terminal-dot-green"></div><span class="ms-3 text-secondary small">.github/workflows/terraform.yml</span></div><div class="terminal-body"><pre class="text-success mb-0">name: Terraform
on:
  pull_request:
    paths: [&#x27;infrastructure/**&#x27;]
  push:
    branches: [main]
    paths: [&#x27;infrastructure/**&#x27;]

jobs:
  plan:
    runs-on: ubuntu-latest
    if: github.event_name == &#x27;pull_request&#x27;
    steps:
      - uses: actions/checkout@v4
      - uses: hashicorp/setup-terraform@v3

      - name: Terraform Plan
        run: |
          cd infrastructure/environments/${{ matrix.environment }}
          terraform init
          terraform plan -out=tfplan -no-color
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

      - name: Post plan to PR
        uses: actions/github-script@v7
        with:
          script: |
            // Post terraform plan output as PR comment

  apply:
    runs-on: ubuntu-latest
    if: github.ref == &#x27;refs/heads/main&#x27;
    environment: production  # Requires manual approval
    steps:
      - uses: actions/checkout@v4
      - uses: hashicorp/setup-terraform@v3

      - name: Terraform Apply
        run: |
          cd infrastructure/environments/${{ matrix.environment }}
          terraform init
          terraform apply -auto-approve</pre></div></div><h2 id="key-takeaways" class="h3 mt-5 mb-3 text-info">Key Takeaways</h2><ol class="text-secondary"><li><strong>Never use local state in production:</strong> Remote backends with locking are non-negotiable for team environments</li><li><strong>Decompose state by lifecycle:</strong> Resources that change at different rates should live in separate state files</li><li><strong>Prefer SSM over remote_state:</strong> Loose coupling between state files reduces blast radius and simplifies refactoring</li><li><strong>Use the hybrid approach:</strong> Shared modules with environment-specific roots give you DRY code and full isolation</li><li><strong>Treat state migration as a production change:</strong> Back up, verify, migrate, verify again</li><li><strong>Enforce access control on state:</strong> Production state writes should be restricted to authorized teams and CI/CD pipelines</li></ol><h2 id="conclusion" class="h3 mt-5 mb-3 text-info">Conclusion</h2><p class="text-secondary">Terraform state management is not glamorous, but getting it wrong can bring production down. The patterns covered here—remote backends, state decomposition, safe migrations, and access control—form the foundation for scaling infrastructure as code across teams and environments. Invest in this foundation early, and your future self will thank you when the organization grows from 5 services to 50.</p><div class="custom-card p-4 mt-5"><div class="d-flex align-items-center"><div class="icon-box me-3" style="width:60px;height:60px"><i class="bi bi-person fs-3"></i></div><div><h5 class="mb-1">Amar Sattaur</h5><p class="text-secondary mb-0 small">Staff DevOps Engineer specializing in infrastructure as code, Kubernetes, and platform engineering.</p></div></div></div><div class="d-flex justify-content-between mt-5 pt-4 border-top border-secondary"><a class="btn btn-outline-custom" href="/blog/argocd-multi-cluster-patterns/"><i class="bi bi-arrow-left me-2"></i>Previous Post</a><a class="btn btn-gradient" href="/blog/">All Posts<i class="bi bi-arrow-right ms-2"></i></a></div></div></div></div></div></article><footer class="footer py-4"><div class="container"><div class="row align-items-center"><div class="col-md-6 text-center text-md-start mb-3 mb-md-0"><span class="text-secondary" style="font-family:monospace"><span class="text-info">&gt;</span> Built with Next.js &amp; Bootstrap</span></div><div class="col-md-6 text-center text-md-end"><span class="text-secondary" style="font-family:monospace">© <!-- -->2026<!-- --> <!-- -->Amar Sattaur</span></div></div></div></footer><!--$--><!--/$--><script src="/_next/static/chunks/c6108499b026e905.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[11414,[\"/_next/static/chunks/9168958f931f481a.js\"],\"default\"]\n3:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n4:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n5:I[47257,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"ClientPageRoot\"]\n6:I[64714,[\"/_next/static/chunks/9168958f931f481a.js\",\"/_next/static/chunks/57336b526124bb98.js\"],\"default\"]\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"OutletBoundary\"]\na:\"$Sreact.suspense\"\nc:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"ViewportBoundary\"]\ne:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"MetadataBoundary\"]\n10:I[68027,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n:HL[\"/_next/static/chunks/d43ab978ac5b76ce.css\",\"style\"]\n:HL[\"/_next/static/chunks/6df63831065a6eda.css\",\"style\"]\n:HC[\"/\",\"\"]\n:HL[\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800\u0026family=JetBrains+Mono:wght@400;500;600;700\u0026display=swap\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"lmWS_xeel-4S4rojSV0d7\",\"c\":[\"\",\"blog\",\"terraform-state-management-at-scale\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[\"terraform-state-management-at-scale\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/d43ab978ac5b76ce.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/6df63831065a6eda.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/9168958f931f481a.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"data-theme\":\"dark\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800\u0026family=JetBrains+Mono:wght@400;500;600;700\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"Amar Sattaur\\\",\\\"jobTitle\\\":\\\"Staff DevOps \u0026 Platform Engineer\\\",\\\"description\\\":\\\"Staff-level DevOps and Platform Engineer specializing in Kubernetes orchestration, CI/CD pipeline architecture, and cloud infrastructure automation.\\\",\\\"url\\\":\\\"https://jodybro.github.io\\\",\\\"email\\\":\\\"ajodasattaur@gmail.com\\\",\\\"sameAs\\\":[\\\"https://github.com/jodybro\\\",\\\"https://linkedin.com/in/amar-sattaur\\\"],\\\"knowsAbout\\\":[\\\"Kubernetes\\\",\\\"Amazon EKS\\\",\\\"Google GKE\\\",\\\"ArgoCD\\\",\\\"Terraform\\\",\\\"GitHub Actions\\\",\\\"CI/CD\\\",\\\"DevOps\\\",\\\"Platform Engineering\\\",\\\"Cloud Infrastructure\\\",\\\"AWS\\\",\\\"GCP\\\",\\\"Oracle Cloud\\\"],\\\"worksFor\\\":{\\\"@type\\\":\\\"Organization\\\",\\\"name\\\":\\\"Mogo Financial\\\"}}\"}}]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"$L5\",null,{\"Component\":\"$6\",\"serverProvidedParams\":{\"searchParams\":{},\"params\":{},\"promises\":[\"$@7\",\"$@8\"]}}],[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/57336b526124bb98.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L9\",null,{\"children\":[\"$\",\"$a\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@b\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Le\",null,{\"children\":[\"$\",\"$a\",null,{\"name\":\"Next.Metadata\",\"children\":\"$Lf\"}]}]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$10\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"7:{}\n8:\"$0:f:0:1:1:children:1:children:1:children:0:props:children:0:props:serverProvidedParams:params\"\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"b:null\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"title\",\"0\",{\"children\":\"Amar Sattaur | Blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Technical writing on Kubernetes, CI/CD, Terraform, and incident leadership.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"Amar Sattaur\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"DevOps Engineer,Platform Engineer,Staff Engineer,Kubernetes,EKS,ArgoCD,Terraform,AWS,GCP,Oracle Cloud,CI/CD,Infrastructure,SRE,GitHub Actions\"}],[\"$\",\"meta\",\"4\",{\"name\":\"creator\",\"content\":\"Amar Sattaur\"}],[\"$\",\"meta\",\"5\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"6\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"7\",{\"rel\":\"canonical\",\"href\":\"https://jodybro.github.io/blog/\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:title\",\"content\":\"Amar Sattaur | Blog\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:description\",\"content\":\"Technical writing on Kubernetes, CI/CD, Terraform, and incident leadership.\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:url\",\"content\":\"https://jodybro.github.io/blog/\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image\",\"content\":\"https://jodybro.github.io/og-blog.svg\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:image:alt\",\"content\":\"Amar Sattaur blog preview\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:title\",\"content\":\"Amar Sattaur | Blog\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:description\",\"content\":\"Technical writing on Kubernetes, CI/CD, Terraform, and incident leadership.\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:image\",\"content\":\"https://jodybro.github.io/og-blog.svg\"}]]\n"])</script></body></html>